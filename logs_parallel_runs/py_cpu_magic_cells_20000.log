Processing magic cells_20000...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)

=== dataset_2_types_equal ===
  -> magic
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.44 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.23 seconds.
    Calculating affinities...
    Calculated affinities in 4.84 seconds.
  Calculated graph and diffusion operator in 11.53 seconds.
  Calculating imputation...
  Calculated imputation in 1.99 seconds.
Calculated MAGIC in 13.54 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.49 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.78 seconds.
    Calculating affinities...
    Calculated affinities in 4.83 seconds.
  Calculated graph and diffusion operator in 12.12 seconds.
  Calculating imputation...
  Calculated imputation in 1.75 seconds.
Calculated MAGIC in 13.88 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.45 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.49 seconds.
    Calculating affinities...
    Calculated affinities in 4.83 seconds.
  Calculated graph and diffusion operator in 11.80 seconds.
  Calculating imputation...
  Calculated imputation in 1.88 seconds.
Calculated MAGIC in 13.69 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.50 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.68 seconds.
    Calculating affinities...
    Calculated affinities in 4.83 seconds.
  Calculated graph and diffusion operator in 12.03 seconds.
  Calculating imputation...
  Calculated imputation in 1.60 seconds.
Calculated MAGIC in 13.64 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.44 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.88 seconds.
    Calculating affinities...
    Calculated affinities in 4.82 seconds.
  Calculated graph and diffusion operator in 12.16 seconds.
  Calculating imputation...
  Calculated imputation in 1.73 seconds.
Calculated MAGIC in 13.90 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.02 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.22 seconds.
    Calculating affinities...
    Calculated affinities in 4.82 seconds.
  Calculated graph and diffusion operator in 12.08 seconds.
  Calculating imputation...
  Calculated imputation in 1.81 seconds.
Calculated MAGIC in 13.90 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.13 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.83 seconds.
    Calculating affinities...
    Calculated affinities in 4.90 seconds.
  Calculated graph and diffusion operator in 12.89 seconds.
  Calculating imputation...
  Calculated imputation in 1.64 seconds.
Calculated MAGIC in 14.53 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.12 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.36 seconds.
    Calculating affinities...
    Calculated affinities in 4.94 seconds.
  Calculated graph and diffusion operator in 12.44 seconds.
  Calculating imputation...
  Calculated imputation in 1.69 seconds.
Calculated MAGIC in 14.13 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.07 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.96 seconds.
    Calculating affinities...
    Calculated affinities in 4.90 seconds.
  Calculated graph and diffusion operator in 11.95 seconds.
  Calculating imputation...
  Calculated imputation in 1.76 seconds.
Calculated MAGIC in 13.73 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1096 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.01 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.21 seconds.
    Calculating affinities...
    Calculated affinities in 4.84 seconds.
  Calculated graph and diffusion operator in 12.08 seconds.
  Calculating imputation...
  Calculated imputation in 1.60 seconds.
Calculated MAGIC in 13.70 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)

=== dataset_3_types_unequal ===
  -> magic
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.13 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.68 seconds.
    Calculating affinities...
    Calculated affinities in 6.25 seconds.
  Calculated graph and diffusion operator in 12.09 seconds.
  Calculating imputation...
  Calculated imputation in 1.70 seconds.
Calculated MAGIC in 13.80 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.08 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.75 seconds.
    Calculating affinities...
    Calculated affinities in 6.25 seconds.
  Calculated graph and diffusion operator in 12.10 seconds.
  Calculating imputation...
  Calculated imputation in 1.72 seconds.
Calculated MAGIC in 13.82 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.03 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.12 seconds.
    Calculating affinities...
    Calculated affinities in 6.30 seconds.
  Calculated graph and diffusion operator in 12.47 seconds.
  Calculating imputation...
  Calculated imputation in 2.00 seconds.
Calculated MAGIC in 14.48 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.08 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.08 seconds.
    Calculating affinities...
    Calculated affinities in 6.18 seconds.
  Calculated graph and diffusion operator in 12.36 seconds.
  Calculating imputation...
  Calculated imputation in 1.72 seconds.
Calculated MAGIC in 14.08 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.11 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.64 seconds.
    Calculating affinities...
    Calculated affinities in 6.50 seconds.
  Calculated graph and diffusion operator in 12.27 seconds.
  Calculating imputation...
  Calculated imputation in 1.71 seconds.
Calculated MAGIC in 14.00 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.12 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.09 seconds.
    Calculating affinities...
    Calculated affinities in 6.16 seconds.
  Calculated graph and diffusion operator in 12.40 seconds.
  Calculating imputation...
  Calculated imputation in 1.78 seconds.
Calculated MAGIC in 14.19 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.07 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.90 seconds.
    Calculating affinities...
    Calculated affinities in 6.01 seconds.
  Calculated graph and diffusion operator in 12.00 seconds.
  Calculating imputation...
  Calculated imputation in 1.68 seconds.
Calculated MAGIC in 13.70 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.03 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.20 seconds.
    Calculating affinities...
    Calculated affinities in 5.62 seconds.
  Calculated graph and diffusion operator in 11.87 seconds.
  Calculating imputation...
  Calculated imputation in 1.61 seconds.
Calculated MAGIC in 13.49 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.07 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.48 seconds.
    Calculating affinities...
    Calculated affinities in 5.72 seconds.
  Calculated graph and diffusion operator in 12.29 seconds.
  Calculating imputation...
  Calculated imputation in 1.72 seconds.
Calculated MAGIC in 14.02 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1094 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.04 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.15 seconds.
    Calculating affinities...
    Calculated affinities in 5.76 seconds.
  Calculated graph and diffusion operator in 11.97 seconds.
  Calculating imputation...
  Calculated imputation in 1.75 seconds.
Calculated MAGIC in 13.73 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)

=== dataset_4_types_rare ===
  -> magic
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.05 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.57 seconds.
    Calculating affinities...
    Calculated affinities in 6.20 seconds.
  Calculated graph and diffusion operator in 11.84 seconds.
  Calculating imputation...
  Calculated imputation in 1.81 seconds.
Calculated MAGIC in 13.66 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.12 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.86 seconds.
    Calculating affinities...
    Calculated affinities in 6.33 seconds.
  Calculated graph and diffusion operator in 12.33 seconds.
  Calculating imputation...
  Calculated imputation in 1.64 seconds.
Calculated MAGIC in 13.98 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.07 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.88 seconds.
    Calculating affinities...
    Calculated affinities in 5.92 seconds.
  Calculated graph and diffusion operator in 11.89 seconds.
  Calculating imputation...
  Calculated imputation in 1.64 seconds.
Calculated MAGIC in 13.54 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.04 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.64 seconds.
    Calculating affinities...
    Calculated affinities in 6.42 seconds.
  Calculated graph and diffusion operator in 12.12 seconds.
  Calculating imputation...
  Calculated imputation in 1.63 seconds.
Calculated MAGIC in 13.76 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.02 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.69 seconds.
    Calculating affinities...
    Calculated affinities in 6.56 seconds.
  Calculated graph and diffusion operator in 12.29 seconds.
  Calculating imputation...
  Calculated imputation in 1.74 seconds.
Calculated MAGIC in 14.05 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.06 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.61 seconds.
    Calculating affinities...
    Calculated affinities in 6.74 seconds.
  Calculated graph and diffusion operator in 12.44 seconds.
  Calculating imputation...
  Calculated imputation in 1.88 seconds.
Calculated MAGIC in 14.32 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.36 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.66 seconds.
    Calculating affinities...
    Calculated affinities in 5.24 seconds.
  Calculated graph and diffusion operator in 11.28 seconds.
  Calculating imputation...
  Calculated imputation in 1.88 seconds.
Calculated MAGIC in 13.17 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.45 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.84 seconds.
    Calculating affinities...
    Calculated affinities in 4.82 seconds.
  Calculated graph and diffusion operator in 11.13 seconds.
  Calculating imputation...
  Calculated imputation in 2.01 seconds.
Calculated MAGIC in 13.15 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.68 seconds.
    Calculating KNN search...
    Calculated KNN search in 5.57 seconds.
    Calculating affinities...
    Calculated affinities in 4.80 seconds.
  Calculated graph and diffusion operator in 12.08 seconds.
  Calculating imputation...
  Calculated imputation in 2.01 seconds.
Calculated MAGIC in 14.10 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1095 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.57 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.18 seconds.
    Calculating affinities...
    Calculated affinities in 4.81 seconds.
  Calculated graph and diffusion operator in 12.58 seconds.
  Calculating imputation...
  Calculated imputation in 1.73 seconds.
Calculated MAGIC in 14.33 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)

=== dataset_multibatch_dropout ===
  -> magic
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.11 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.08 seconds.
    Calculating affinities...
    Calculated affinities in 4.87 seconds.
  Calculated graph and diffusion operator in 12.07 seconds.
  Calculating imputation...
  Calculated imputation in 1.26 seconds.
Calculated MAGIC in 13.34 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.15 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.13 seconds.
    Calculating affinities...
    Calculated affinities in 4.88 seconds.
  Calculated graph and diffusion operator in 12.19 seconds.
  Calculating imputation...
  Calculated imputation in 1.25 seconds.
Calculated MAGIC in 13.44 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.00 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.17 seconds.
    Calculating affinities...
    Calculated affinities in 5.52 seconds.
  Calculated graph and diffusion operator in 12.72 seconds.
  Calculating imputation...
  Calculated imputation in 1.25 seconds.
Calculated MAGIC in 13.98 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.11 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.64 seconds.
    Calculating affinities...
    Calculated affinities in 6.19 seconds.
  Calculated graph and diffusion operator in 11.97 seconds.
  Calculating imputation...
  Calculated imputation in 1.60 seconds.
Calculated MAGIC in 13.57 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.43 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.50 seconds.
    Calculating affinities...
    Calculated affinities in 7.02 seconds.
  Calculated graph and diffusion operator in 14.96 seconds.
  Calculating imputation...
  Calculated imputation in 1.56 seconds.
Calculated MAGIC in 16.53 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.41 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.56 seconds.
    Calculating affinities...
    Calculated affinities in 6.85 seconds.
  Calculated graph and diffusion operator in 14.84 seconds.
  Calculating imputation...
  Calculated imputation in 1.58 seconds.
Calculated MAGIC in 16.44 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.47 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.57 seconds.
    Calculating affinities...
    Calculated affinities in 6.92 seconds.
  Calculated graph and diffusion operator in 14.98 seconds.
  Calculating imputation...
  Calculated imputation in 1.57 seconds.
Calculated MAGIC in 16.55 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.16 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.63 seconds.
    Calculating affinities...
    Calculated affinities in 4.90 seconds.
  Calculated graph and diffusion operator in 10.70 seconds.
  Calculating imputation...
  Calculated imputation in 1.28 seconds.
Calculated MAGIC in 11.99 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.02 seconds.
    Calculating KNN search...
    Calculated KNN search in 4.63 seconds.
    Calculating affinities...
    Calculated affinities in 6.58 seconds.
  Calculated graph and diffusion operator in 12.25 seconds.
  Calculating imputation...
  Calculated imputation in 1.54 seconds.
Calculated MAGIC in 13.80 seconds.
Calculating MAGIC...
  Running MAGIC on 20000 cells and 1097 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 1.40 seconds.
    Calculating KNN search...
    Calculated KNN search in 6.45 seconds.
    Calculating affinities...
    Calculated affinities in 6.79 seconds.
  Calculated graph and diffusion operator in 14.66 seconds.
  Calculating imputation...
  Calculated imputation in 1.55 seconds.
Calculated MAGIC in 16.22 seconds.
Wrote results_imputation_py/magic/cells_20000/magic_mse_table.tsv

Processing magic datasets from datasets...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)

--- Dataset: blakeley_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.04 seconds.
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.05 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ARI=0.2544 NMI=0.3879 PS=0.6867

--- Dataset: darmanis_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ARI=0.6023 NMI=0.7587 PS=0.8476

--- Dataset: deng_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ARI=0.3341 NMI=0.4874 PS=0.6508

--- Dataset: pollen_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ARI=0.7358 NMI=0.8198 PS=0.7813

--- Dataset: usoskin_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.03 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
  Calculated imputation in 0.01 seconds.
Calculated MAGIC in 0.07 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.05 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
  Calculated imputation in 0.01 seconds.
Calculated MAGIC in 0.06 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.03 seconds.
    Calculating KNN search...
    Calculated KNN search in 0.09 seconds.
    Calculating affinities...
    Calculated affinities in 0.03 seconds.
  Calculated graph and diffusion operator in 0.15 seconds.
  Calculating imputation...
  Calculated imputation in 0.01 seconds.
Calculated MAGIC in 0.16 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.03 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.06 seconds.
  Calculating imputation...
  Calculated imputation in 0.01 seconds.
Calculated MAGIC in 0.07 seconds.
    ARI=0.9551 NMI=0.9290 PS=0.9752
Saved results_clustering_py/magic/magic_clustering_table.tsv
Finished [PY/magic]

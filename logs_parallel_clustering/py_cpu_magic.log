Processing magic datasets from datasets...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)

--- Dataset: blakeley_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.03 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.05 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.02 seconds.
  Calculating imputation...
Calculated MAGIC in 0.02 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.02 seconds.
  Calculating imputation...
Calculated MAGIC in 0.02 seconds.
Calculating MAGIC...
  Running MAGIC on 30 cells and 1000 genes.
  Calculating graph and diffusion operator...
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/graphtools/base.py:165: RuntimeWarning: Cannot perform PCA to 100 dimensions on data with min(n_samples, n_features) = 30
  warnings.warn(
    Calculating KNN search...
    Calculated KNN search in 0.01 seconds.
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.02 seconds.
  Calculating imputation...
Calculated MAGIC in 0.02 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ASW=0.6902 ARI=0.8038 NMI=0.7254 PS=0.8667

--- Dataset: darmanis_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.04 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
Calculating MAGIC...
  Running MAGIC on 420 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.04 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ASW=0.6168 ARI=0.8272 NMI=0.8445 PS=0.8976

--- Dataset: deng_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 268 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ASW=0.7401 ARI=0.5620 NMI=0.8021 PS=0.8582

--- Dataset: pollen_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
Calculating MAGIC...
  Running MAGIC on 299 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.01 seconds.
    Calculating KNN search...
    Calculating affinities...
  Calculated graph and diffusion operator in 0.03 seconds.
  Calculating imputation...
Calculated MAGIC in 0.03 seconds.
/mnt/nfs/home/marcin.malec.local/miniconda3/envs/magic311/lib/python3.11/site-packages/rds2py/PyRdsReader.py:105: RuntimeWarning: Unsupported R object type: other
  warn(f"Unsupported R object type: {rtype}", RuntimeWarning)
    ASW=0.8764 ARI=0.9024 NMI=0.9226 PS=0.9231

--- Dataset: usoskin_top1000hvg ---
  -> magic
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.06 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.05 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.06 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.01 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.05 seconds.
Calculating MAGIC...
  Running MAGIC on 622 cells and 1000 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 0.02 seconds.
    Calculating KNN search...
    Calculating affinities...
    Calculated affinities in 0.02 seconds.
  Calculated graph and diffusion operator in 0.05 seconds.
  Calculating imputation...
Calculated MAGIC in 0.06 seconds.
    ASW=0.5468 ARI=0.9053 NMI=0.8629 PS=0.9447
Saved results_clustering_py/magic/magic_clustering_table.tsv
Finished [PY/magic]
